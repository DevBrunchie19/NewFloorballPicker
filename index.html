<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Floorball Team Picker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
/* --- Base Styles --- */
body {
  font-family: Arial, sans-serif;
  max-width: 600px;
  margin: 40px auto;
  padding: 20px;
  background: #f9f9f9;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
h1 {
  padding: 12px;
  background: #3a52a3;
  text-align: center;
  border-radius: 8px;
  color: #fff;
}
textarea, input {
  width: 100%;
  margin-top: 6px;
  padding: 12px;
  border-radius: 6px;
  border: 1px solid #ccc;
}
.chips-container {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 12px;
}
.chip {
  padding: 8px 14px;
  background: #e0e0e0;
  border-radius: 20px;
  cursor: pointer;
  transition: 0.2s;
}
.chip.selected {
  background: #3a52a3;
  color: white;
}

/* --- Teamsheet Mode --- */
.team {
  background: white;
  border: 1px solid #ddd;
  padding: 14px;
  border-radius: 10px;
  margin-top: 12px;
}

.team-title {
  font-size: 1.2rem;
  font-weight: bold;
  text-align: center;
  margin-bottom: 10px;
}

.teamsheet {
  display: grid;
  grid-template-columns: repeat(3,1fr);
  gap: 20px;
  text-align: center;
  padding: 10px 0;
}

.player-icon {
  width: 60px;
  height: 60px;
  background: #3a52a3;
  border-radius: 50%;
  margin: auto;
}

.player-name {
  margin-top: 6px;
  font-weight: 600;
}
</style>
</head>

<body>
<h1>Floorball Team Picker</h1>

<!-- Player Chips -->
<div class="chips-header"><strong>The usual suspects:</strong></div>
<div id="playerChips" class="chips-container"></div>

<div class="chips-header"><strong>Goalies:</strong></div>
<div id="goalieChips" class="chips-container"></div>

<label>Enter additional players (comma separated):</label>
<textarea id="names" placeholder="Gretzky, McLovin, ..."></textarea>

<label>Team size:</label>
<div id="teamSizeChips" class="chips-container">
  <div class="chip" onclick="selectTeamSize(3, this)">3</div>
  <div class="chip" onclick="selectTeamSize(5, this)">5</div>
</div>
<input type="number" id="teamSize" placeholder="3">

<button onclick="generateTeams()">Generate Teams</button>

<h2>Teams:</h2>
<div id="output"></div>

<script>
/* -----------------------------
   Data + UI Setup
-------------------------------- */
const commonPlayers = ["Brunchie", "Colin W-B", "Nabber", "Ben", "Bill", "Ron", "Eugene"];
const goalies = ["Colin D", "Sam", "ClothGimp"];

document.addEventListener("DOMContentLoaded", () => {
  createChips(commonPlayers, "playerChips", togglePlayer);
  createChips(goalies, "goalieChips", toggleGoalie);
});

/* -----------------------------
   Helper Functions
-------------------------------- */
function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    let j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}

function createChips(list, containerId, handler) {
  const container = document.getElementById(containerId);
  list.forEach(name => {
    const chip = document.createElement("div");
    chip.className = "chip";
    chip.textContent = name;
    chip.onclick = () => handler(name, chip);
    container.appendChild(chip);
  });
}

function togglePlayer(name, chip) {
  chip.classList.toggle("selected");
  syncTextareaFromChips();
}

function toggleGoalie(name, chip) {
  chip.classList.toggle("selected");
}

function selectTeamSize(size, chip) {
  document.getElementById("teamSize").value = size;
  document.querySelectorAll("#teamSizeChips .chip").forEach(c => c.classList.remove("selected"));
  chip.classList.add("selected");
}

function syncTextareaFromChips() {
  const selected = Array.from(document.querySelectorAll("#playerChips .chip.selected")).map(c => c.textContent);
  document.getElementById("names").value = selected.join(", ");
}

function getPlayers() {
  const textareaNames = document.getElementById("names").value
    .split(",")
    .map(n => n.trim())
    .filter(n => n.length);
  return textareaNames;
}

function getSelectedGoalies() {
  return Array.from(document.querySelectorAll("#goalieChips .chip.selected"))
    .map(c => c.textContent);
}

/* -----------------------------
   Team Generation
-------------------------------- */
function generateTeams() {
  let players = getPlayers();
  const teamSize = parseInt(document.getElementById("teamSize").value);
  const selectedGoalies = getSelectedGoalies();

  if (!teamSize || teamSize < 1) {
    alert("Enter a valid team size");
    return;
  }

  shuffle(players);

  const numTeams = Math.floor(players.length / teamSize);
  if (numTeams === 0) {
    document.getElementById("output").innerHTML = "<p>Not enough players.</p>";
    return;
  }

  const teams = [];

  for (let i = 0; i < numTeams; i++) {
    teams.push(players.splice(0, teamSize));
  }

  // Distribute leftovers to teams evenly
  let idx = 0;
  while (players.length) {
    teams[idx % numTeams].push(players.shift());
    idx++;
  }

  // Insert rotating goalies
  teams.forEach((team, i) => {
    if (selectedGoalies.length) {
      const goalie = selectedGoalies[i % selectedGoalies.length] + " (G)";
      team.unshift(goalie);
    }
  });

  // Render them
  renderTeams(teams, teamSize);
}

/* -----------------------------
   Rendering Logic
-------------------------------- */
function renderTeams(teams, size) {
  const teamNames = [
    "The Five-Hole Fiddlers", "Goal Diggers", "Ball Blazers", "Stick Flickers",
    "The Mighty Dangles", "Deez Sticks", "Floor Fury", "The Dirty Dekes",
    "Stickflix and Chill", "The Deflectors", "Ballz Deep",
    "Just the Tip-Ins", "The Slap and Tickles",
  ];

  shuffle(teamNames);
  const output = document.getElementById("output");
  output.innerHTML = "";

  teams.forEach((team, i) => {
    let html = `<div class="team"><div class="team-title">${teamNames[i]}</div>`;

    if (size === 3) {
      html += `<div class="teamsheet">`;
      team.forEach(p => {
        html += `
          <div>
            <div class="player-icon"></div>
            <div class="player-name">${p.includes("(G)") ? "ðŸ§¤ " + p : p}</div>
          </div>`;
      });
      html += `</div></div>`;
    } else {
      html += `<p>${team.join(", ")}</p></div>`;
    }

    output.innerHTML += html;
  });
}
</script>
</body>
</html>
